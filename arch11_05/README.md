# WealthCompas - Бот для анализа недвижимости в Дубае

WealthCompas - это Telegram-бот, который предоставляет аналитику о рынке недвижимости в Дубае на основе данных, хранящихся в PostgreSQL базе данных. Бот использует LangChain и DeepSeek LLM для создания информативных ответов на естественном языке.

## Возможности

- Ежедневная публикация аналитических отчетов о разных районах Дубая в Telegram-канал
- Ответы на вопросы пользователей о рынке недвижимости в Дубае
- Анализ данных из базы данных PostgreSQL с использованием LangChain SQL
- Генерация детальных ответов с использованием DeepSeek LLM через OpenRouter API

## Установка

1. Клонируйте репозиторий:

```bash
git clone https://github.com/your-username/wealthcompas.git
cd wealthcompas
```

2. Установите необходимые зависимости:

```bash
pip install -r requirements.txt
```

3. Переименуйте `env_file.txt` в `.env` и заполните необходимые переменные окружения:

```bash
# Под Windows
copy env_file.txt .env

# Под Linux/macOS
cp env_file.txt .env
```

4. Отредактируйте файл `.env`, добавив ваши API ключи и настройки.

## Настройка базы данных

1. Убедитесь, что PostgreSQL установлен и запущен.

2. Создайте таблицу для хранения данных о недвижимости:

```bash
python update_schema.py
```

3. Загрузите данные о недвижимости из CSV-файла:

```bash
python load_csv_full.py
```

## Запуск

### Запуск Telegram-бота

```bash
python main.py
```

### Тестирование LangChain SQL интеграции

```bash
python test_langchain_sql.py
```

## Структура проекта

- `main.py` - Основной файл проекта, содержащий логику Telegram-бота
- `langchain_sql_integration.py` - Модуль для интеграции LangChain с SQL
- `load_csv_full.py` - Скрипт для загрузки данных из CSV в базу данных
- `update_schema.py` - Скрипт для создания и обновления схемы базы данных
- `test_langchain_sql.py` - Тестовый скрипт для проверки LangChain SQL интеграции
- `news_collector.py` - Модуль для сбора новостей о рынке недвижимости
- `config.py` - Конфигурационный файл проекта
- `env_file.txt` - Шаблон файла с переменными окружения

## Принцип работы

1. Пользователь отправляет вопрос Telegram-боту
2. Бот анализирует вопрос и генерирует SQL-запрос с использованием LangChain
3. SQL-запрос выполняется для получения данных из базы PostgreSQL
4. DeepSeek LLM анализирует результаты запроса и генерирует ответ на естественном языке
5. Ответ отправляется пользователю через Telegram

## Ежедневные отчеты

Бот автоматически публикует ежедневные отчеты о рынке недвижимости в указанный Telegram-канал. Расписание и темы отчетов настраиваются в файле `.env` с использованием промптов для каждого дня недели.

## Требования

- Python 3.8+
- PostgreSQL
- Telegram Bot API Token
- OpenRouter API Key (для доступа к DeepSeek LLM) 