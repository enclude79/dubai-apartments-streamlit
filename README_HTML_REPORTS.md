# Публикация HTML-отчетов о недвижимости в Дубае

Этот инструмент генерирует HTML-отчеты на основе данных из базы данных PostgreSQL и публикует их на вашем хостинге, а также отправляет ссылки в ваш Telegram канал.

## Преимущества этого подхода

- **Независимость от локального сервера**: отчеты остаются доступными даже когда ваш компьютер выключен
- **Нет ограничений туннелирования**: не нужны ngrok или localtunnel с их ограничениями
- **Постоянные ссылки**: ссылки не меняются и могут быть сохранены пользователями
- **Быстрая загрузка**: статические HTML-страницы загружаются быстрее, чем динамические Streamlit-приложения

## Настройка

1. Убедитесь, что у вас есть FTP-доступ к вашему хостингу
2. Добавьте настройки FTP в файл `.env`:

```
# FTP настройки для публикации отчетов
FTP_HOST=ваш-ftp-хост.com
FTP_USER=ваш-ftp-пользователь
FTP_PASSWORD=ваш-ftp-пароль
FTP_DIRECTORY=/public_html/dubai-reports/
BASE_URL=https://ваш-домен.com/dubai-reports/
```

## Зависимости

```
pip install pandas numpy folium jinja2 python-telegram-bot python-dotenv psycopg2
```

## Использование

Просто запустите скрипт:

```
python telegram_html_publisher.py
```

Скрипт выполнит следующие действия:
1. Подключится к базе данных PostgreSQL
2. Извлечет данные о самых дешевых квартирах
3. Сгенерирует HTML-отчет с интерактивной картой, графиками и таблицами
4. Загрузит отчет на ваш хостинг через FTP
5. Отправит ссылку на отчет в ваш Telegram канал

## Автоматическое расписание

Вы можете настроить регулярное выполнение скрипта с помощью планировщика задач:

### Windows (Task Scheduler)

1. Откройте Task Scheduler (Планировщик заданий)
2. Создайте новую задачу с действием: `python C:\путь\к\telegram_html_publisher.py`
3. Настройте расписание (например, ежедневно в 9:00)

### Linux (Cron)

Добавьте в crontab:

```
0 9 * * * python /путь/к/telegram_html_publisher.py
```

## Структура отчета

Сгенерированный HTML-отчет содержит:

1. **Интерактивную карту** с маркерами квартир (разные цвета для разных рангов)
2. **График** с топ-10 регионов с самыми низкими ценами
3. **Таблицу** со всеми квартирами и возможностью сортировки

## Примечания

- Отчеты сохраняются локально в папке `reports/` перед загрузкой на хостинг
- Для каждого отчета генерируется уникальное имя файла на основе даты и времени
- Вам не нужно настраивать запуск Streamlit или веб-сервера 